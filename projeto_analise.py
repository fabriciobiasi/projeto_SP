# -*- coding: utf-8 -*-
"""Projeto_analise

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/11kw20nt7YvFxihBP6MenzcFV8tB1odg8

# An√°lise de Poluentes em S√£o Paulo

Este notebook analisa dados da qualidade do ar em S√£o Paulo, com foco nos poluentes MP10 e O‚ÇÉ. Vamos investigar padr√µes temporais e poss√≠veis quedas durante a pandemia.

## Importa√ß√£o de bibliotecas e leitura dos dados
"""

import pandas as pd
import matplotlib.pyplot as plt
import numpy as np
import seaborn as sns
caminho = 'dados/SP_poluicao_dados.csv'
dados = pd.read_csv(caminho)

dados = dados.drop(columns = ['Unnamed: 0', 'ID'])

dados.head()

"""## Limpeza e prepara√ß√£o dos dados


"""

dados['DataHora'] = pd.to_datetime(dados['Data'] + ' ' + dados['Hora'])
print(dados.dtypes)
print(dados.isnull().sum())

"""## An√°lise dos tipos de poluentes"""

#Tipos de Poluentes em SP!
tipos_poluentes = dados['Poluente'].unique()
print('Tipos de poluentes que existem em SP: ', tipos_poluentes)
contagem_poluentes = (dados['Poluente']).value_counts()
print(contagem_poluentes)
contagem_poluentes.plot(kind = 'bar')
plt.title('Quantidade de medi√ß√µes por tipo de poluente')
plt.xlabel('Poluentes')
plt.ylabel('Quantidade')
#Vemos que o poluente que mais aparece seria o MP10 por ser um poluente feito por ve√≠culos!
plt.savefig('poluentes.png', dpi=300, bbox_inches='tight')
plt.show()

"""## An√°lise da contagem de medi√ß√µes por ano


"""

#Realizando a contagem de medi√ß√µes por m√™s
dados['M√™s'] = dados['DataHora'].dt.month
dados['Ano'] = dados['DataHora'].dt.year
medicoes_anuais = dados.groupby('Ano').size().reset_index(name='Contagem')
print(medicoes_anuais)
plt.bar(medicoes_anuais['Ano'],medicoes_anuais['Contagem'])
plt.title('Contagem de medi√ß√µes por ano')
plt.xlabel('Ano')
plt.ylabel('N√∫mero de medi√ß√µes')
plt.savefig('contagem.png', dpi=300, bbox_inches='tight')
plt.show()

"""## An√°lise do poluente MP10

"""

#Realizando o c√°lculo de m√©dia di√°rio do MP10
mp10 = (dados['Poluente'] == 'MP10')
dados_mp10 = dados[mp10]
dados['Data'] = dados['DataHora'].dt.date
media_diaria = dados_mp10.groupby('Data')['Valor'].mean().reset_index()
media_diaria.rename(columns={'Valor': 'MediaMP10'}, inplace=True)
mp10_graph = plt.plot(media_diaria['Data'], media_diaria['MediaMP10'], color='blue')
plt.title('M√©dia Di√°ria de MP10 em S√£o Paulo')
plt.xlabel('Data')
plt.ylabel('MP10 (ug/m3)')

plt.savefig('grafico_mp10.png', dpi=300, bbox_inches='tight')
plt.show()

media_diaria['Data'] = pd.to_datetime(media_diaria['Data'])
media_diaria['Ano'] = media_diaria['Data'].dt.year
media_anual = media_diaria.groupby('Ano')['MediaMP10'].mean().reset_index()
print(media_anual)
media_anual.columns = ['Ano', 'MediaMP10']
plt.plot(media_anual['Ano'], media_anual['MediaMP10'])
plt.title('M√©dia anual do Poluente MP10')
plt.xlabel('Ano')
plt.ylabel('M√©dia')

plt.savefig('grafico_mp10_anual.png', dpi=300, bbox_inches='tight')
plt.show()

"""## An√°lise do oz√¥nio (O‚ÇÉ) // Segundo maior poluente

"""

contagem_o3 = dados['Poluente'] == 'O3'
dados_o3 = dados[contagem_o3]
dados_o3.value_counts('Poluente')
dados_o3['Data'] = pd.to_datetime(dados_o3['DataHora']).dt.date
media_diaria_o3 = dados_o3.groupby('Data')['Valor'].mean().reset_index()
plt.plot(media_diaria_o3['Data'], media_diaria_o3['Valor'], color='red')
plt.title('M√©dia Di√°ria de O‚ÇÉ em S√£o Paulo')
plt.xlabel('Data')
plt.ylabel('O‚ÇÉ (¬µg/m¬≥)')

"""## An√°lise comparativa entre os dois primeiros poluentes

###Relembrando:
### - O3 √© um g√°s agressivo que penetra nas vias respirat√≥rias, reduzindo o funcionamento pulmonar e causando danos a ele. Al√©m disso, o poluente O3 √© formado por rea√ß√µes com poluentes prim√°rios, como √≥xidos de nitrog√™nio;
### - MP10 √© causado por processos industriais, ve√≠culos automotores, queimadas, poeira do solo e atividades agr√≠colas.

### Distribui√ß√£o da m√©dia anual dos poluentes MP10 e O‚ÇÉ (2015‚Äì2021)
Observamos uma **tend√™ncia de queda nos n√≠veis de O‚ÇÉ (oz√¥nio troposf√©rico)** entre 2015 e 2017, com posterior estabiliza√ß√£o at√© 2021. Essa redu√ß√£o pode estar relacionada a **menores emiss√µes de precursores do oz√¥nio**, como os √≥xidos de nitrog√™nio (NOx) e compostos org√¢nicos vol√°teis (COVs), frequentemente associados ao tr√°fego urbano e √† ind√∫stria. Al√©m disso, fatores clim√°ticos e medidas restritivas durante a pandemia tamb√©m podem ter influenciado.
Em contrapartida, o **MP10 apresenta uma tend√™ncia de crescimento** ao longo dos anos, o que pode estar associado ao **aumento da frota de ve√≠culos, obras urbanas e condi√ß√µes clim√°ticas secas** que favorecem a concentra√ß√£o de part√≠culas no ar. Por ser um poluente diretamente emitido, o MP10 √© um indicador mais direto da atividade urbana e do tr√°fego intenso.
"""

filtro = dados['Poluente'].isin(['MP10', 'O3'])
dados_filtrados = dados[filtro]
media_anuais = dados_filtrados.groupby(['Ano', 'Poluente'])['Valor'].mean().reset_index()

plt.figure(figsize=(10, 6))
sns.lineplot(data=media_anuais, x='Ano', y='Valor', hue='Poluente', marker='o')
plt.title('M√©dia anual dos poluentes MP10 e O‚ÇÉ em S√£o Paulo (2015‚Äì2021)')
plt.ylabel('Concentra√ß√£o m√©dia (¬µg/m¬≥)')
plt.grid(True)
plt.tight_layout()
plt.show()

"""### Distribui√ß√£o anual dos poluentes MP10 e O‚ÇÉ (2015‚Äì2021)

O boxplot permite visualizar a dispers√£o dos dados ao longo dos anos. O **MP10 apresenta maior variabilidade**, com v√°rios valores extremos (outliers), o que indica picos de concentra√ß√£o ao longo do tempo. Isso √© esperado, pois o MP10 est√° fortemente ligado √† atividade urbana direta, como o tr√¢nsito e obras.

O **O‚ÇÉ, por outro lado, mostra uma distribui√ß√£o mais concentrada**, com menos varia√ß√µes bruscas ano a ano. Essa estabilidade refor√ßa a natureza secund√°ria do oz√¥nio, formado a partir de rea√ß√µes qu√≠micas e menos sujeito a emiss√µes diretas pontuais.

Al√©m disso, observa-se que a **mediana do MP10 manteve-se relativamente constante ou em leve crescimento**, enquanto o O‚ÇÉ estabilizou ap√≥s uma queda entre 2015 e 2017.

"""

plt.figure(figsize=(12, 6))
sns.boxplot(data=dados_filtrados, x='Ano', y='Valor', hue='Poluente')
plt.title('Distribui√ß√£o anual dos poluentes MP10 e O‚ÇÉ (2015‚Äì2021)')
plt.ylabel('Concentra√ß√£o (¬µg/m¬≥)')
plt.xlabel('Ano')
plt.legend(title='Poluente')
plt.grid(True)
plt.tight_layout()
plt.show()

"""##Pandemia x Poluentes

###Durante a pandemia de COVID-19, diversos estudos relataram redu√ß√£o da polui√ß√£o do ar em √°reas urbanas. Neste etapa, analisamos os n√≠veis m√©dios de todos os poluentes monitorados em S√£o Paulo entre 2019 e 2021.
"""

dados_pandemia = dados[dados['Ano'].between(2019, 2021)]
media_anuais_todos = dados_pandemia.groupby(['Ano', 'Poluente'])['Valor'].mean().reset_index()
plt.figure(figsize=(14, 7))
sns.lineplot(data=media_anuais_todos, x='Ano', y='Valor', hue='Poluente', marker='o')
plt.title('Comparativo da m√©dia anual de todos os poluentes (2019‚Äì2021)')
plt.xlabel('Ano')
plt.ylabel('Concentra√ß√£o m√©dia (¬µg/m¬≥)')
plt.legend(title='Poluente')
plt.grid(True)
plt.tight_layout()
plt.show()

pivot = media_anuais_todos.pivot(index='Poluente', columns='Ano', values='Valor')
plt.figure(figsize=(10, 6))
sns.heatmap(pivot, annot=True, fmt=".1f", cmap="coolwarm")
plt.title('M√©dias anuais de concentra√ß√£o dos poluentes (2019‚Äì2021)')
plt.ylabel('Poluente')
plt.xlabel('Ano')
plt.tight_layout()
plt.show()

"""## ü¶† Impacto da Pandemia na Polui√ß√£o (2019‚Äì2021)

Durante o per√≠odo de pandemia, especialmente em 2020, S√£o Paulo passou por diversas restri√ß√µes de circula√ß√£o, lockdowns e queda nas atividades industriais. Isso teve reflexo direto nos n√≠veis de alguns poluentes:

- O **CO (mon√≥xido de carbono)** apresentou a maior queda, refor√ßando seu v√≠nculo com o tr√°fego urbano.
- Outros poluentes como **PTS, NO‚ÇÇ e FMC** tamb√©m ca√≠ram em 2020, mas voltaram a subir ou estabilizaram em 2021.
- J√° o **O‚ÇÉ (oz√¥nio)** se manteve est√°vel, como esperado de um poluente secund√°rio, que depende de rea√ß√µes atmosf√©ricas.
- **MP10 e MP2.5** mostraram varia√ß√£o m√≠nima ‚Äî o que pode indicar que fontes como poeira, obras e queima de biomassa continuaram ativas mesmo durante restri√ß√µes.

Esses dados mostram, com base cient√≠fica, que **mudan√ßas no comportamento urbano geram impacto quase imediato na qualidade do ar.**
"""